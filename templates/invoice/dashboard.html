{% extends 'partials/base.html' %}"

{% load static %}"

{% block css %}"
    <link rel="stylesheet" href="{% static 'assets/css/calendar.css' %}">

{% endblock %}"


{% block main %}"


<div class="content-body">
      <div class="container-fluid">
        <!-- row -->
            <div class="row">
                <div class="col-xl-3 col-xxl-6 col-sm-6">
                    <div class="card bg-primary">
                        <div class="card-body">
                            <div class="media align-items-center">

                                <div class="media-body text-left">
                                    <p class="fs-18 text-white mb-2">سفارشات</p>
                                    <span class="fs-48 text-white font-w600">{{invoices}}</span>
                                </div>
                                <span class="p-3 ml-3 feature-icon rounded">
										<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
											<path d="M30.25 5.75H28.5V2.25C28.5 1.78587 28.3156 1.34075 27.9874 1.01256C27.6593 0.684374 27.2141 0.5 26.75 0.5C26.2859 0.5 25.8407 0.684374 25.5126 1.01256C25.1844 1.34075 25 1.78587 25 2.25V5.75H11V2.25C11 1.78587 10.8156 1.34075 10.4874 1.01256C10.1592 0.684374 9.71413 0.5 9.25 0.5C8.78587 0.5 8.34075 0.684374 8.01256 1.01256C7.68437 1.34075 7.5 1.78587 7.5 2.25V5.75H5.75C4.35761 5.75 3.02226 6.30312 2.03769 7.28769C1.05312 8.27226 0.5 9.60761 0.5 11V12.75H35.5V11C35.5 9.60761 34.9469 8.27226 33.9623 7.28769C32.9777 6.30312 31.6424 5.75 30.25 5.75Z" fill="white"/>
											<path d="M0.5 30.25C0.5 31.6424 1.05312 32.9777 2.03769 33.9623C3.02226 34.9469 4.35761 35.5 5.75 35.5H30.25C31.6424 35.5 32.9777 34.9469 33.9623 33.9623C34.9469 32.9777 35.5 31.6424 35.5 30.25V16.25H0.5V30.25Z" fill="white"/>
										</svg>
									</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-xxl-6 col-sm-6">
                    <div class="card bg-info">
                        <div class="card-body">
                            <div class="media align-items-center">
                                <div class="media-body text-left">
                                    <p class="fs-18 text-white mb-2">مشتریان</p>
                                    <span class="fs-48 text-white font-w600">{{clientsC}}</span>
                                </div>
									<span class="p-3 ml-3 feature-icon rounded">
										<svg width="36" height="36" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
											<path fill-rule="evenodd" clip-rule="evenodd" d="M15.1811 22.0083C15.065 21.9063 14.7968 21.6695 14.7015 21.5799C12.3755 19.3941 10.8517 15.9712 10.8517 12.1138C10.8517 5.37813 15.4868 0.0410156 21.001 0.0410156C26.5152 0.0410156 31.1503 5.37813 31.1503 12.1138C31.1503 15.9679 29.6292 19.3884 27.3094 21.5778C27.2118 21.6699 26.9384 21.9116 26.8238 22.0125L26.8139 22.1799C26.8789 23.1847 27.554 24.0553 28.5232 24.3626C35.7277 26.641 40.9507 32.0853 41.8276 38.538C41.9483 39.3988 41.6902 40.2696 41.1198 40.9254C40.5495 41.5813 39.723 41.9579 38.8541 41.9579C32.4956 41.9591 9.50672 41.9591 3.14818 41.9591C2.2787 41.9591 1.4518 41.5824 0.881242 40.9263C0.31068 40.2701 0.0523763 39.3989 0.172318 38.5437C1.05145 32.0851 6.27444 26.641 13.4777 24.3628C14.4504 24.0544 15.1263 23.1802 15.1885 22.1722L15.1811 22.0083Z" fill="white"/>
										</svg>
									</span>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- row -->
        <div class="container-fluid">
            <div class="page-titles">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">پنل</a></li>
                    <li class="breadcrumb-item active"><a href="javascript:void(0)">تقویم</a></li>
                </ol>
            </div>
            <!-- row -->

              <div class="container-fluid">

                <div class="col-xl-11">
         
                          <div class="container-fluid">
                           


                                <table id="cal1" class="fc-table">

                                     <caption>
                                        <label for="fc-year">سال:</label>
                                        <select name="fc-year" class="fc-year">
                                            <option value="1391">1391</option>
                                            <option value="1392">1392</option>
                                            <option value="1393">1393</option>
                                            <option value="1394">1394</option>
                                            <option value="1395">1395</option>
                                            <option value="1396">1396</option>
                                            <option value="1397">1397</option>
                                            <option value="1398">1398</option>
                                            <option value="1399">1399</option>
                                            <option value="1400">1400</option>
                                            <option value="1401">1401</option>
                                        </select>

                                        <label for="fc-month">ماه:</label>
                                         <select name="fc-month" class="fc-month">
                                            <option value="0">فروردین</option>
                                            <option value="1">اردیبهشت</option>
                                            <option value="2">خرداد</option>
                                            <option value="3">تیر</option>
                                            <option value="4">مرداد</option>
                                            <option value="5">شهریور</option>
                                            <option value="6">مهر</option>
                                            <option value="7">آبان</option>
                                            <option value="8">آذر</option>
                                            <option value="9">دی</option>
                                            <option value="10">بهمن</option>
                                            <option value="11">اسفند</option>
                                        </select>
                                    </caption>
                                        <tr>
                                        <th>شنبه</th>
                                        <th>یکشنبه</th>
                                        <th>دوشنبه</th>
                                        <th>سه شنبه</th>
                                        <th>چهارشنبه</th>
                                        <th>پنچشنبه</th>
                                        <th>جمعه</th>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                   </table>
                                </div>
                       
                       </div> </div>
                  
                </div>
            
          </div>

    </div>
</div>


    <!--**********************************
        Content body end
    ***********************************-->

{% endblock %}"

{% block scripts %}"
<!--**********************************
    Scripts
***********************************-->
<script src="{% static 'assets/js/jalali.js' %}"></script>
<script src="{% static 'assets/js/hijri.js' %}"></script>
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<script src="{% static 'assets/vendor/bootstrap-datetimepicker/js/moment.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/jqueryui/js/jquery-ui.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/moment/moment.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/fullcalendar/js/moment-jalaali.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/fullcalendar/js/fullcalendar.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/vendor/fullcalendar/js/locale-all.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/js/dashboard/dashboard-1.js' %}" type="text/javascript"></script>

<script>
    $(document).ready(function () {
        InitCalendar($("#cal1"));
    });

    var _year;
    var _month;
    var _day = 1;
    var _currDay;
    var _jlcal = new JalaliCal();
    var _hjcal = new HijriCal();

    /* sets table and calendar defaults */
    function InitCalendar(table) {
        var today = new Date();
        var year = today.getFullYear();
        var month = today.getMonth() + 1;
        var day = today.getDate();
        var dayofweek;

        var jalaliDate = _jlcal.toJalaali(year, month, day);
        _year = jalaliDate.jy;
        _month = jalaliDate.jm - 1;
        $(".fc-year").val(_year);
        $(".fc-month").val(_month);
        UpdateCal(table, _year, _month, _day);
    }

    /* updates table values */
    function UpdateCal(table, year, month, day) {
        var today, dayOfWeek, daysInMonth, count = 1;
        var tb = $(table), td;
        var j2g, g2h;
        var now = new Date();

        j2g = _jlcal.toGregorian(year, month + 1, 1);
        today = new Date(j2g.gy, j2g.gm - 1, j2g.gd);
        dayOfWeek = today.getDay();
        dayOfWeek = (dayOfWeek == 6) ? 0 : dayOfWeek + 1;
        daysInMonth = _jlcal.jalaaliMonthLength(year, month);

        if ((dayOfWeek == 5 && daysInMonth > 30) || (dayOfWeek == 6 && daysInMonth >= 30)) {
            $(tb).find("tr:last").removeClass("hidden");
        }
        else {
            $(tb).find("tr:last").addClass("hidden");
        }

        $(tb).find("td span").popover("destroy");
        $(tb).find("td").text("")
            .removeAttr("data-jl")
            .removeAttr("data-gr")
            .removeAttr("data-hj")
            .removeClass("dayoff");
        td = $(tb).find("td");

        for (var index = dayOfWeek; index < daysInMonth + dayOfWeek; index++) {
            var element = td[index];
            j2g = _jlcal.toGregorian(year, month + 1, count);
            g2h = _hjcal.toHijri(j2g.gy, j2g.gm - 1, j2g.gd);
            today = new Date(j2g.gy, j2g.gm - 1, j2g.gd);

            if (gd2Txt(today.getDay()) == "Fir" || isoff("jl", month, count) || isoff("hj", g2h.hm, g2h.hd)) {
                $(element).addClass("dayoff");
            }
            $(element).attr("data-jl", (year + "-" + (month + 1) + "-" + count));
            $(element).attr("data-gr", (today.getFullYear() + "-" + (today.getMonth() + 1) + "-" + today.getDate()));
            $(element).attr("data-hj", (g2h.hy + "-" + (g2h.hm + 1) + "-" + g2h.hd));
            $(element).html(
                "<b>" + count + "</b>" + "\n" +
                "<span>" +
                "<div class='font-fa tdinfo'>" +
                g2h.hy + " " + hm2Txt(g2h.hm) + " " + g2h.hd +
                "</div>" +
                "<div class='font-eng tdinfo'>" +
                gd2Txt(today.getDay()) + " " +
                gm2Txt(today.getMonth()) + " " +
                today.getDate() + " " +
                today.getFullYear() +
                "</div></span>"
            );
            count++;
        }
    }

    /* handle events */
    $(".fc-year").change(function () {
        _year = parseInt($(this).find(":selected").val());
        UpdateCal($(this).closest("table"), _year, _month, _day);
    });
    $(".fc-month").change(function () {
        _month = parseInt($(this).find(":selected").val());
        UpdateCal($(this).closest("table"), _year, _month, _day);
    });
    $(".fc-table td").on("click", function (e) {
        $tb = $(this).closest("table");
        $(".fc-table td span").popover("destroy");
        if ($(this).attr("data-jl") && $(this).attr("data-gr")) {
            var title = "", content = "";
            _currDay = $(this);
            var jl = $(this).attr("data-jl").split("-");
            var wc = $(this).attr("data-gr").split("-");
            var hj = $(this).attr("data-hj").split("-");
            $.ajax({
                url: "https://farsicalendar.com/api/sh,wc,ic/" +
                jl[2] + "," + wc[2] + "," + hj[2] + "/" + jl[1] + "," + wc[1] + "," + hj[1],
                type: "GET",
                dataType: 'json',
                date: { limit: 3 },
                success: function (data) {
                    console.log(data);
                    title = "رویدادهای امروز:";
                    content += "<ul>";
                    if (data.values.length == 0) {
                        content += "<li>" + "موردی یافت نشد" + "</li>";
                    } else {
                        $.each(data.values, function (index, item) {
                            if (item.dayoff == true) {
                                content += "<li class='dayoff'>" + item.occasion + "</li>";
                            }
                            else {
                                content += "<li>" + item.occasion + "</li>";
                            }
                        });
                    }
                    content += "</ul>";
                    $(_currDay).children("span").popover({
                        title: title,
                        content: content,
                        container: 'body',
                        placement: "bottom auto",
                        html: true
                    });
                    $(_currDay).children("span").popover("show");
                },
                error: function () {
                    console.log("error!!!");
                }
            });
            e.preventDefault();
        }
    });

    /* helpers */
    function gd2Txt(day) {
        switch (day) {
            case 0:
                return "Sun";
                break;
            case 1:
                return "Mon";
                break;
            case 2:
                return "Tue";
                break;
            case 3:
                return "Wed";
                break;
            case 4:
                return "Thu";
                break;
            case 5:
                return "Fir";
                break;
            case 6:
                return "Sat";
                break;
            default:
                return "خطا";
                break;
        }
    }
    function gm2Txt(mon) {
        switch (mon) {
            case 0:
                return "Jan";
                break;
            case 1:
                return "Feb";
                break;
            case 2:
                return "Mar";
                break;
            case 3:
                return "Apr";
                break;
            case 4:
                return "May";
                break;
            case 5:
                return "Jun";
                break;
            case 6:
                return "Jul";
                break;
            case 7:
                return "Aug";
                break;
            case 8:
                return "Sep";
                break;
            case 9:
                return "Oct";
                break;
            case 10:
                return "Nov";
                break;
            case 11:
                return "Dec";
                break;
            default:
                return "خطا";
                break;
        }
    }
    function hm2Txt(mon) {
        switch (mon) {
            case 0:
                return "محرم";
                break;
            case 1:
                return "صفر";
                break;
            case 2:
                return "ربیع الاول";
                break;
            case 3:
                return "ربیع الثانی";
                break;
            case 4:
                return "جمادی الاول";
                break;
            case 5:
                return "جمادی الثانی";
                break;
            case 6:
                return "رجب";
                break;
            case 7:
                return "شعبان";
                break;
            case 8:
                return "رمضان";
                break;
            case 9:
                return "شوال";
                break;
            case 10:
                return "ذی القعده";
                break;
            case 11:
                return "ذی الحجه";
                break;
            default:
                return "خطا";
                break;
        }
    }
    function isoff(calType, mon, day) {
        var jlDayoff = [
            "1/1", "1/2", "1/3", "1/4", "1/12", "1/13",
            "3/14", "3/15", "11/22", "12/29"];
        var hjDayoff = [
            "1/9", "1/10", "2/20", "2/28", "2/30", "3/17", "6/3", "7/13",
            "7/27", "8/15", "9/21", "10/1", "10/2", "10/25", "12/10", "12/18"];

        mon += 1;
        if (calType == "jl") {
            if (jlDayoff.indexOf(mon + "/" + day) != -1)
                return true;
            else
                return false;
        }
        if (calType == "hj") {
            if (hjDayoff.indexOf(mon + "/" + day) != -1)
                return true
            else
                return false;
        }
    }

</script>

{% endblock %}"
